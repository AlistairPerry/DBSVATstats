setwd("/mnt/data/alistairp/Park/M")
setwd("/mnt/data/alistairp/Park/PDmultivariate/Data")
alldata<-read.csv("extractedlongout.csv")
View(alldata)
library("mixAK")
ip <- getProfiles(t="TimePoint", y=alldata[,3:8], id="ID", data= alldata)
View(alldata)
alldata<-as.data.frame(alldata)
ip <- getProfiles(t="TimePoint", y=alldata[,3:8], id="ID", data= alldata)
alldata[,3:8]
ip <- getProfiles(t="TimePoint", y=c("BIS_Total","EQ_Total","UPDRS","Hayling_ABErrorScore","ELF_Violations","DelayDiscount"), id="ID", data= alldata)
plotProfiles(ip)
plotProfiles(ip, data = alldata, var = "Hayling_ABErrorScore",tvar="TimePoint")
plotProfiles(ip, data = alldata, var = "ELF_Violations",tvar="TimePoint")
plotProfiles(ip, data = alldata, var = "BIS_Total",tvar="TimePoint")
plotProfiles(ip, data = alldata, var = "BIS_Total",tvar="TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "Hayling_ABErrorScore",tvar="TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "UPDRS",tvar="TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscount",tvar=TimePoint",highlight=c(1,length(ip)))
}
plotProfiles(ip, data = alldata, var = "DelayDiscount",tvar=TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscount",tvar=TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscount",tvar=TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar=TimePoint , highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoint"" , highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoint"" , highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoint"" , highlight=c(1,length(ip))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoint"" , highlight=c(1,length(ip))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoint", highlight=c(1,length(ip))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoint", highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoitzighlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscout",tvar="TimePoitzighlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "Hayling_ABErrorScore",tvar="TimePoint",highlight=c(1,length(ip)))
mod <- GLMM_MCMC(y = alldata[,3:8],id=alldata[,"ID"])
mod <- GLMM_MCMC(y = alldata[,3:8],id=alldata[,"ID"],  dist = c("gaussian"))
mod <- GLMM_MCMC(y = alldata[,3:8],id=alldata[,"ID"],  dist = c("gaussian"),x="empty", z=list(BIS_Total=alldata[,"TimePoint"],EQ_Total=alldata[,"TimePoint"],UPDRS=alldata[,"TimePoint"]))
mod <- GLMM_MCMC(y = alldata[,3:5],id=alldata[,"ID"],  dist = c("gaussian"),x="empty", z=list(BIS_Total=alldata[,"TimePoint"],EQ_Total=alldata[,"TimePoint"],UPDRS=alldata[,"TimePoint"]))
mod <- GLMM_MCMC(y = alldata[,3:5],id=alldata[,"ID"],  dist = c("gaussian"),x=list(BIS_Total="empty",EQ_Total="empty",UPDRS="empty"), z=list(BIS_Total=alldata[,"TimePoint"],EQ_Total=alldata[,"TimePoint"],UPDRS=alldata[,"TimePoint"]))
mod <- GLMM_MCMC(y = alldata[,3:5],id=alldata[,"ID"],  dist = c("gaussian"),x=list(BIS_Total="empty",EQ_Total="empty",UPDRS="empty"), z=list(BIS_Total=alldata[,"TimePoint"],EQ_Total=alldata[,"TimePoint"],UPDRS=alldata[,"TimePoint"]),prior.b = list(Kmax = 2))
K <- mod[[1]]$prior.b$Kmax
plotProfiles(ip, data = alldata, var = "Hayling_ABErrorScore",tvar="TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "Hayling_ABErrorScore",tvar="TimePoint",highlight=c(1,length(ip)))
iShow <- c(1, length(ip))
layout(autolayout(3))
plotProfiles(ip, data = alldata, var = "Hayling_ABErrorScore",tvar="TimePoint",highlight=c(1,length(ip)))
plotProfiles(ip, data = alldata, var = "DelayDiscount",tvar="TimePoint",highlight=c(1,length(ip)))
print(mod)
tpred <- seq(0, 30, by = delta)
delta <- 0.3
tpred <- seq(0, 30, by = delta)
fit <- fitted(mod[[1]], x =list("empty", "empty", tpred),
+ z =list(tpred, tpred, "empty")    + glmer = TRUE)
fit <- fitted(mod[[1]], x =list("empty", "empty", tpred), z =list(tpred, tpred, "empty")    + glmer = TRUE)
fit <- fitted(mod[[1]], x =list("empty", "empty", tpred), z =list(tpred, tpred, "empty"),glmer = TRUE)
fit <- fitted(mod[[1]], x =list("empty", "empty", "empty"), z =list(tpred, tpred, tpred),glmer = TRUE)
names(fit) <- c("BIS_Total","EQ_Total","UPDRS")
print(fit[["UPDRS"],[1:3,], digits = 5)
print(fit[["UPDRS"]][1:3,], digits = 5)
clCOL <- c("darkgreen", "red3")
plotProfiles(ip = ip, data = alldata, var = "UPDRS",tvar = "TimePoint", col = "azure3")
for (k in 1:K) lines(tpred, fit[["UPDRS"]][, k], col = clCOL[k], lwd = 2)
print(fit["BIS_Total"]][1:3,], digits = 5)
print(fit[["BIS_Total"]][1:3,], digits = 5)
print(fit[["EQ_Total"]][1:3,], digits = 5)
mod <- GLMM_MCMC(y = alldata[,3:5],id=alldata[,"ID"],  dist = c("gaussian"))
mod <- GLMM_MCMC(y = alldata[,3:5],id=alldata[,"ID"],  dist = c("gaussian"),z=list(BIS_Total=alldata[,"TimePoint"],EQ_Total=alldata[,"TimePoint"],UPDRS=alldata[,"TimePoint"]),prior.b = list(Kmax = 2))
fit <- fitted(mod[[1]], z =list(tpred, tpred, tpred),glmer = TRUE)
print(fit[["BIS_Total"]][1:3,], digits = 5)
View(alldata)
